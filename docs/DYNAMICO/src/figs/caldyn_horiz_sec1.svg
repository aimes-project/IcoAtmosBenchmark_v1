<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.0//EN'
          'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'>
<svg stroke-dasharray="none" shape-rendering="auto" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" font-family="'Dialog'" text-rendering="auto" width="894" fill-opacity="1" color-interpolation="auto" color-rendering="auto" font-size="12px" viewBox="0 0 894 836" fill="black" xmlns:xlink="http://www.w3.org/1999/xlink" stroke="black" image-rendering="auto" stroke-miterlimit="10" stroke-linecap="square" stroke-linejoin="miter" font-style="normal" stroke-width="1" height="836" stroke-dashoffset="0" font-weight="normal" stroke-opacity="1"
><!--Generated by the Batik Graphics2D SVG Generator--><defs id="genericDefs"
  /><g
  ><g fill="white" text-rendering="geometricPrecision" stroke-width="2" font-size="14px" font-family="sans-serif" stroke="white"
    ><rect x="10" y="10" width="645" rx="24" ry="16" height="24" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="28" stroke="none"
      >subroutine compute_caldyn_horiz(u,rhodz,qu,theta,pk,geopot, hflux,convm, dtheta_rhodz, du)</text
      ><rect x="10" y="10" fill="none" width="645" rx="24" ry="16" height="24" stroke="rgb(51,51,51)"
      /><rect x="10" y="44" width="90" rx="24" ry="16" height="24" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="62" stroke="none"
      >section 1</text
      ><rect x="10" y="44" fill="none" width="90" rx="24" ry="16" height="24" stroke="rgb(51,51,51)"
      /><text fill="rgb(51,51,51)" x="198.624" xml:space="preserve" y="96" stroke="none"
      >(Compute mass and theta fluxes)</text
      ><rect x="478.4912" width="192.9941" height="24" y="112" stroke="none"
      /><text fill="rgb(51,51,51)" x="503.4912" xml:space="preserve" y="130" stroke="none"
      >test_message(req_qu)</text
      ><rect fill="none" x="478.4912" width="192.9941" height="24" y="112" stroke="rgb(51,51,51)"
      /><line y2="136" fill="none" x1="488.4912" x2="488.4912" stroke="rgb(51,51,51)" y1="112"
      /><line y2="136" fill="none" x1="661.4854" x2="661.4854" stroke="rgb(51,51,51)" y1="112"
      /><line y2="112" fill="none" x1="463.4912" x2="478.4912" stroke="rgb(51,51,51)" y1="112"
      /><polygon points=" 183 112 463 112 423 136 463 160 183 160" stroke="none"
      /><text fill="rgb(51,51,51)" x="404.7109" xml:space="preserve" y="130" stroke="none"
      > </text
      ><text fill="rgb(51,51,51)" x="400.9307" xml:space="preserve" y="154" stroke="none"
      >  </text
      ><text fill="rgb(51,51,51)" x="198.624" xml:space="preserve" y="142" stroke="none"
      >(caldyn_conserv==energy)</text
      ><polygon fill="none" points=" 183 112 463 112 423 136 463 160 183 160" stroke="rgb(51,51,51)"
      /><rect x="402.9941" width="438.4541" height="38" y="170" stroke="none"
      /><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="188" stroke="none"
      >hflux(ij+u_right,l)</text
      ><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="202" stroke="none"
      >=0.5*(rhodz(ij,l)+rhodz(ij+t_right,l))*u(ij+u_right,l)*le(ij+u_right)</text
      ><rect fill="none" x="402.9941" width="438.4541" height="38" y="170" stroke="rgb(51,51,51)"
      /><rect x="402.9941" width="411.0146" height="38" y="218" stroke="none"
      /><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="236" stroke="none"
      >hflux(ij+u_lup,l)  </text
      ><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="250" stroke="none"
      >=0.5*(rhodz(ij,l)+rhodz(ij+t_lup,l))*u(ij+u_lup,l)*le(ij+u_lup)</text
      ><rect fill="none" x="402.9941" width="411.0146" height="38" y="218" stroke="rgb(51,51,51)"
      /><rect x="402.9941" width="468.0879" height="38" y="266" stroke="none"
      /><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="284" stroke="none"
      >hflux(ij+u_ldown,l)</text
      ><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="298" stroke="none"
      >=0.5*(rhodz(ij,l)+rhodz(ij+t_ldown,l))*u(ij+u_ldown,l)*le(ij+u_ldown)</text
      ><rect fill="none" x="402.9941" width="468.0879" height="38" y="266" stroke="rgb(51,51,51)"
      /><rect x="402.9941" width="366.4102" height="38" y="314" stroke="none"
      /><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="332" stroke="none"
      >Ftheta(ij+u_right,l)</text
      ><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="346" stroke="none"
      >=0.5*(theta(ij,l)+theta(ij+t_right,l))*hflux(ij+u_right,l)</text
      ><rect fill="none" x="402.9941" width="366.4102" height="38" y="314" stroke="rgb(51,51,51)"
      /><rect x="402.9941" width="348.1172" height="38" y="362" stroke="none"
      /><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="380" stroke="none"
      >Ftheta(ij+u_lup,l)  </text
      ><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="394" stroke="none"
      >=0.5*(theta(ij,l)+theta(ij+t_lup,l))*hflux(ij+u_lup,l)</text
      ><rect fill="none" x="402.9941" width="348.1172" height="38" y="362" stroke="rgb(51,51,51)"
      /><rect x="402.9941" width="386.166" height="38" y="410" stroke="none"
      /><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="428" stroke="none"
      >Ftheta(ij+u_ldown,l)</text
      ><text fill="rgb(51,51,51)" x="417.9941" xml:space="preserve" y="442" stroke="none"
      >=0.5*(theta(ij,l)+theta(ij+t_ldown,l))*hflux(ij+u_ldown,l)</text
      ><rect fill="none" x="402.9941" width="386.166" height="38" y="410" stroke="rgb(51,51,51)"
      /><line y2="448" fill="none" x1="402.9941" x2="402.9941" stroke="rgb(51,51,51)" y1="170"
      /><line y2="170" fill="none" x1="387.9941" x2="402.9941" stroke="rgb(51,51,51)" y1="170"
      /><rect x="183.624" width="204.3701" height="24" y="170" stroke="none"
      /><text fill="rgb(51,51,51)" x="208.624" xml:space="preserve" y="188" stroke="none"
      >ij=ij_begin_ext,ij_end_ext</text
      ><rect fill="none" x="183.624" width="204.3701" height="24" y="170" stroke="rgb(51,51,51)"
      /><line y2="194" fill="none" x1="193.624" x2="193.624" stroke="rgb(51,51,51)" y1="170"
      /><text fill="rgb(51,51,51)" x="198.624" xml:space="preserve" y="476" stroke="none"
      >(compute horizontal divergence of fluxes)</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="510" stroke="none"
      >(convm = -div(mass flux), sign convention as in Ringler et al. 2012, eq. 21)</text
      ><rect x="349.6875" width="381.1484" height="94" y="526" stroke="none"
      /><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="544" stroke="none"
      >convm(ij,l)= -1./Ai(ij)*(ne_right*hflux(ij+u_right,l)   +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="558" stroke="none"
      >ne_rup*hflux(ij+u_rup,l)       +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="572" stroke="none"
      >ne_lup*hflux(ij+u_lup,l)       +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="586" stroke="none"
      >ne_left*hflux(ij+u_left,l)     +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="600" stroke="none"
      >ne_ldown*hflux(ij+u_ldown,l)   +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="614" stroke="none"
      >ne_rdown*hflux(ij+u_rdown,l))</text
      ><rect fill="none" x="349.6875" width="381.1484" height="94" y="526" stroke="rgb(51,51,51)"
      /><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="648" stroke="none"
      >(signe ? attention d (rho theta dz))</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="682" stroke="none"
      >(dtheta_rhodz =  -div(flux.theta))</text
      ><rect x="349.6875" width="434.7012" height="94" y="698" stroke="none"
      /><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="716" stroke="none"
      >dtheta_rhodz(ij,l)=-1./Ai(ij)*(ne_right*Ftheta(ij+u_right,l)    +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="730" stroke="none"
      >ne_rup*Ftheta(ij+u_rup,l)        +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="744" stroke="none"
      >ne_lup*Ftheta(ij+u_lup,l)        +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="758" stroke="none"
      >ne_left*Ftheta(ij+u_left,l)      +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="772" stroke="none"
      >ne_ldown*Ftheta(ij+u_ldown,l)    +  &amp;</text
      ><text fill="rgb(51,51,51)" x="364.6875" xml:space="preserve" y="786" stroke="none"
      >ne_rdown*Ftheta(ij+u_rdown,l))</text
      ><rect fill="none" x="349.6875" width="434.7012" height="94" y="698" stroke="rgb(51,51,51)"
      /><line y2="792" fill="none" x1="349.6875" x2="349.6875" stroke="rgb(51,51,51)" y1="492"
      /><line y2="492" fill="none" x1="334.6875" x2="349.6875" stroke="rgb(51,51,51)" y1="492"
      /><rect x="183.624" width="151.0635" height="24" y="492" stroke="none"
      /><text fill="rgb(51,51,51)" x="208.624" xml:space="preserve" y="510" stroke="none"
      >ij=ij_begin,ij_end</text
      ><rect fill="none" x="183.624" width="151.0635" height="24" y="492" stroke="rgb(51,51,51)"
      /><line y2="516" fill="none" x1="193.624" x2="193.624" stroke="rgb(51,51,51)" y1="492"
      /><line y2="516" fill="none" x1="183.624" x2="183.624" stroke="rgb(51,51,51)" y1="78"
      /><line y2="78" fill="none" x1="168.624" x2="183.624" stroke="rgb(51,51,51)" y1="78"
      /><rect x="10" width="158.624" height="24" y="78" stroke="none"
      /><text fill="rgb(51,51,51)" x="35" xml:space="preserve" y="96" stroke="none"
      >l = ll_begin, ll_end</text
      ><rect fill="none" x="10" width="158.624" height="24" y="78" stroke="rgb(51,51,51)"
      /><line y2="102" fill="none" x1="20" x2="20" stroke="rgb(51,51,51)" y1="78"
      /><rect x="10" y="802" width="144" rx="24" ry="16" height="24" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="820" stroke="none"
      >cont. to section 2</text
      ><rect x="10" y="802" fill="none" width="144" rx="24" ry="16" height="24" stroke="rgb(51,51,51)"
      /><line y2="810" fill="none" x1="10" x2="10" stroke="rgb(51,51,51)" y1="26"
    /></g
  ></g
></svg
>
