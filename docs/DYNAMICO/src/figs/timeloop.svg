<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.0//EN'
          'http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd'>
<svg stroke-dasharray="none" shape-rendering="auto" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" font-family="'Dialog'" text-rendering="auto" width="1072" fill-opacity="1" color-interpolation="auto" color-rendering="auto" font-size="12px" viewBox="0 0 1072 948" fill="black" xmlns:xlink="http://www.w3.org/1999/xlink" stroke="black" image-rendering="auto" stroke-miterlimit="10" stroke-linecap="square" stroke-linejoin="miter" font-style="normal" stroke-width="1" height="948" stroke-dashoffset="0" font-weight="normal" stroke-opacity="1"
><!--Generated by the Batik Graphics2D SVG Generator--><defs id="genericDefs"
  /><g
  ><g fill="white" text-rendering="geometricPrecision" stroke-width="2" font-size="14px" font-family="sans-serif" stroke="white"
    ><rect x="10" y="10" width="187" rx="24" ry="16" height="26" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="28" stroke="none"
      >SUBROUTINE timeloop</text
      ><rect x="10" y="10" fill="none" width="187" rx="24" ry="16" height="26" stroke="rgb(51,51,51)"
      /><rect x="10" width="56.7012" height="26.2969" y="46.2969" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="64.2969" stroke="none"
      >......</text
      ><rect fill="none" x="10" width="56.7012" height="26.2969" y="46.2969" stroke="rgb(51,51,51)"
      /><rect x="251.7373" width="56.7012" height="26.2969" y="82.5938" stroke="none"
      /><text fill="rgb(51,51,51)" x="266.7373" xml:space="preserve" y="100.5938" stroke="none"
      >......</text
      ><rect fill="none" x="251.7373" width="56.7012" height="26.2969" y="82.5938" stroke="rgb(51,51,51)"
      /><rect x="671.3057" width="252.4121" height="26.2969" y="118.8906" stroke="none"
      /><text fill="rgb(51,51,51)" x="696.3057" xml:space="preserve" y="136.8906" stroke="none"
      >send_message(f_ps,req_ps0)</text
      ><rect fill="none" x="671.3057" width="252.4121" height="26.2969" y="118.8906" stroke="rgb(51,51,51)"
      /><line y2="145.1875" fill="none" x1="681.3057" x2="681.3057" stroke="rgb(51,51,51)" y1="118.8906"
      /><line y2="145.1875" fill="none" x1="913.7178" x2="913.7178" stroke="rgb(51,51,51)" y1="118.8906"
      /><rect x="671.3057" width="215.5938" height="26.2969" y="155.1875" stroke="none"
      /><text fill="rgb(51,51,51)" x="696.3057" xml:space="preserve" y="173.1875" stroke="none"
      >wait_message(req_ps0)</text
      ><rect fill="none" x="671.3057" width="215.5938" height="26.2969" y="155.1875" stroke="rgb(51,51,51)"
      /><line y2="181.4844" fill="none" x1="681.3057" x2="681.3057" stroke="rgb(51,51,51)" y1="155.1875"
      /><line y2="181.4844" fill="none" x1="876.8994" x2="876.8994" stroke="rgb(51,51,51)" y1="155.1875"
      /><rect x="671.3057" width="56.7012" height="26.2969" y="191.4844" stroke="none"
      /><text fill="rgb(51,51,51)" x="686.3057" xml:space="preserve" y="209.4844" stroke="none"
      >......</text
      ><rect fill="none" x="671.3057" width="56.7012" height="26.2969" y="191.4844" stroke="rgb(51,51,51)"
      /><line y2="217.7812" fill="none" x1="671.3057" x2="671.3057" stroke="rgb(51,51,51)" y1="118.8906"
      /><line y2="118.8906" fill="none" x1="656.3057" x2="671.3057" stroke="rgb(51,51,51)" y1="118.8906"
      /><polygon points=" 251 118 656 118 616 173 656 227 251 227" stroke="none"
      /><text fill="rgb(51,51,51)" x="596.8555" xml:space="preserve" y="136.8906" stroke="none"
      > </text
      ><text fill="rgb(51,51,51)" x="592.4053" xml:space="preserve" y="219.4844" stroke="none"
      >  </text
      ><text fill="rgb(51,51,51)" x="266.7373" xml:space="preserve" y="178.1875" stroke="none"
      >(it==itau0+1 .OR. MOD(it,itau_sync)==0)</text
      ><polygon fill="none" points=" 251 118 656 118 616 173 656 227 251 227" stroke="rgb(51,51,51)"
      /><rect x="251.7373" width="56.7012" height="26.2969" y="237.7812" stroke="none"
      /><text fill="rgb(51,51,51)" x="266.7373" xml:space="preserve" y="255.7812" stroke="none"
      >......</text
      ><rect fill="none" x="251.7373" width="56.7012" height="26.2969" y="237.7812" stroke="rgb(51,51,51)"
      /><rect x="434.3096" width="424.6914" height="75.1875" y="274.0781" stroke="none"
      /><text fill="rgb(51,51,51)" x="459.3096" xml:space="preserve" y="292.0781" stroke="none"
      >caldyn</text
      ><text fill="rgb(51,51,51)" x="459.3096" xml:space="preserve" y="308.375" stroke="none"
      >((stage==1) .AND. (MOD(it,itau_out)==0), &amp;</text
      ><text fill="rgb(51,51,51)" x="459.3096" xml:space="preserve" y="324.6719" stroke="none"
      >f_phis,f_ps,f_mass,f_theta_rhodz,f_u, f_q, &amp;</text
      ><text fill="rgb(51,51,51)" x="459.3096" xml:space="preserve" y="340.9688" stroke="none"
      >f_hflux, f_wflux, f_dps, f_dmass, f_dtheta_rhodz, f_du)</text
      ><rect fill="none" x="434.3096" width="424.6914" height="75.1875" y="274.0781" stroke="rgb(51,51,51)"
      /><line y2="349.2656" fill="none" x1="444.3096" x2="444.3096" stroke="rgb(51,51,51)" y1="274.0781"
      /><line y2="349.2656" fill="none" x1="849.001" x2="849.001" stroke="rgb(51,51,51)" y1="274.0781"
      /><rect x="678.8164" width="243.8535" height="26.2969" y="359.2656" stroke="none"
      /><text fill="rgb(51,51,51)" x="703.8164" xml:space="preserve" y="377.2656" stroke="none"
      >rk_scheme(stage, coef_rk4)</text
      ><rect fill="none" x="678.8164" width="243.8535" height="26.2969" y="359.2656" stroke="rgb(51,51,51)"
      /><line y2="385.5625" fill="none" x1="688.8164" x2="688.8164" stroke="rgb(51,51,51)" y1="359.2656"
      /><line y2="385.5625" fill="none" x1="912.6699" x2="912.6699" stroke="rgb(51,51,51)" y1="359.2656"
      /><line y2="359.2656" fill="none" x1="663.8164" x2="678.8164" stroke="rgb(51,51,51)" y1="359.2656"
      /><rect x="678.8164" width="252.7607" height="26.2969" y="411.8594" stroke="none"
      /><text fill="rgb(51,51,51)" x="703.8164" xml:space="preserve" y="429.8594" stroke="none"
      >rk_scheme(stage, coef_rk25)</text
      ><rect fill="none" x="678.8164" width="252.7607" height="26.2969" y="411.8594" stroke="rgb(51,51,51)"
      /><line y2="438.1562" fill="none" x1="688.8164" x2="688.8164" stroke="rgb(51,51,51)" y1="411.8594"
      /><line y2="438.1562" fill="none" x1="921.5771" x2="921.5771" stroke="rgb(51,51,51)" y1="411.8594"
      /><line y2="411.8594" fill="none" x1="663.8164" x2="678.8164" stroke="rgb(51,51,51)" y1="411.8594"
      /><rect x="678.8164" width="66.9004" height="26.2969" y="464.4531" stroke="none"
      /><text fill="rgb(51,51,51)" x="693.8164" xml:space="preserve" y="482.4531" stroke="none"
      >STOP</text
      ><rect fill="none" x="678.8164" width="66.9004" height="26.2969" y="464.4531" stroke="rgb(51,51,51)"
      /><line y2="464.4531" fill="none" x1="663.8164" x2="678.8164" stroke="rgb(51,51,51)" y1="464.4531"
      /><polygon points=" 434 359 663 359 623 385 663 411 623 438 663 464 434 464" stroke="none"
      /><text fill="rgb(51,51,51)" x="575.1221" xml:space="preserve" y="377.2656" stroke="none"
      >(rk4)</text
      ><text fill="rgb(51,51,51)" x="566.2148" xml:space="preserve" y="416.7109" stroke="none"
      >(rk25)</text
      ><text fill="rgb(51,51,51)" x="544.9619" xml:space="preserve" y="456.1562" stroke="none"
      >DEFAULT</text
      ><text fill="rgb(51,51,51)" x="449.3096" xml:space="preserve" y="416.7109" stroke="none"
      >(scheme)</text
      ><polygon fill="none" points=" 434 359 663 359 623 385 663 411 623 438 663 464 434 464" stroke="rgb(51,51,51)"
      /><rect x="434.3096" width="56.7012" height="26.2969" y="510.75" stroke="none"
      /><text fill="rgb(51,51,51)" x="449.3096" xml:space="preserve" y="528.75" stroke="none"
      >......</text
      ><rect fill="none" x="434.3096" width="56.7012" height="26.2969" y="510.75" stroke="rgb(51,51,51)"
      /><text fill="rgb(51,51,51)" x="449.3096" xml:space="preserve" y="565.0469" stroke="none"
      >(update q and rhodz after RK step)</text
      ><rect x="434.3096" width="379.7041" height="26.2969" y="583.3438" stroke="none"
      /><text fill="rgb(51,51,51)" x="459.3096" xml:space="preserve" y="601.3438" stroke="none"
      >advect_tracer(f_hfluxt,f_wfluxt,f_u, f_q,f_rhodz)</text
      ><rect fill="none" x="434.3096" width="379.7041" height="26.2969" y="583.3438" stroke="rgb(51,51,51)"
      /><line y2="609.6406" fill="none" x1="444.3096" x2="444.3096" stroke="rgb(51,51,51)" y1="583.3438"
      /><line y2="609.6406" fill="none" x1="804.0137" x2="804.0137" stroke="rgb(51,51,51)" y1="583.3438"
      /><rect x="434.3096" width="56.7012" height="26.2969" y="619.6406" stroke="none"
      /><text fill="rgb(51,51,51)" x="449.3096" xml:space="preserve" y="637.6406" stroke="none"
      >......</text
      ><rect fill="none" x="434.3096" width="56.7012" height="26.2969" y="619.6406" stroke="rgb(51,51,51)"
      /><line y2="645.9375" fill="none" x1="434.3096" x2="434.3096" stroke="rgb(51,51,51)" y1="274.0781"
      /><line y2="274.0781" fill="none" x1="419.3096" x2="434.3096" stroke="rgb(51,51,51)" y1="274.0781"
      /><rect x="251.7373" width="167.5723" height="26.2969" y="274.0781" stroke="none"
      /><text fill="rgb(51,51,51)" x="276.7373" xml:space="preserve" y="292.0781" stroke="none"
      >stage=1,nb_stage</text
      ><rect fill="none" x="251.7373" width="167.5723" height="26.2969" y="274.0781" stroke="rgb(51,51,51)"
      /><line y2="300.375" fill="none" x1="261.7373" x2="261.7373" stroke="rgb(51,51,51)" y1="274.0781"
      /><rect x="614.4648" width="426.4209" height="26.2969" y="655.9375" stroke="none"
      /><text fill="rgb(51,51,51)" x="639.4648" xml:space="preserve" y="673.9375" stroke="none"
      >check_conserve(f_ps,f_dps,f_u,f_theta_rhodz,f_phis,it)</text
      ><rect fill="none" x="614.4648" width="426.4209" height="26.2969" y="655.9375" stroke="rgb(51,51,51)"
      /><line y2="682.2344" fill="none" x1="624.4648" x2="624.4648" stroke="rgb(51,51,51)" y1="655.9375"
      /><line y2="682.2344" fill="none" x1="1030.8857" x2="1030.8857" stroke="rgb(51,51,51)" y1="655.9375"
      /><line y2="655.9375" fill="none" x1="599.4648" x2="614.4648" stroke="rgb(51,51,51)" y1="655.9375"
      /><polygon points=" 251 655 599 655 559 682 599 708 251 708" stroke="none"
      /><text fill="rgb(51,51,51)" x="540.0146" xml:space="preserve" y="673.9375" stroke="none"
      > </text
      ><text fill="rgb(51,51,51)" x="535.5645" xml:space="preserve" y="700.2344" stroke="none"
      >  </text
      ><text fill="rgb(51,51,51)" x="266.7373" xml:space="preserve" y="687.0859" stroke="none"
      >(MOD(it,itau_check_conserv)==0)</text
      ><polygon fill="none" points=" 251 655 599 655 559 682 599 708 251 708" stroke="rgb(51,51,51)"
      /><rect x="563.6123" width="426.8311" height="26.2969" y="718.5312" stroke="none"
      /><text fill="rgb(51,51,51)" x="588.6123" xml:space="preserve" y="736.5312" stroke="none"
      >physics(it,f_phis, f_ps, f_theta_rhodz, f_u, f_wflux, f_q)</text
      ><rect fill="none" x="563.6123" width="426.8311" height="26.2969" y="718.5312" stroke="rgb(51,51,51)"
      /><line y2="744.8281" fill="none" x1="573.6123" x2="573.6123" stroke="rgb(51,51,51)" y1="718.5312"
      /><line y2="744.8281" fill="none" x1="980.4434" x2="980.4434" stroke="rgb(51,51,51)" y1="718.5312"
      /><line y2="718.5312" fill="none" x1="548.6123" x2="563.6123" stroke="rgb(51,51,51)" y1="718.5312"
      /><polygon points=" 251 718 548 718 508 744 548 771 251 771" stroke="none"
      /><text fill="rgb(51,51,51)" x="489.1621" xml:space="preserve" y="736.5312" stroke="none"
      > </text
      ><text fill="rgb(51,51,51)" x="484.7119" xml:space="preserve" y="762.8281" stroke="none"
      >  </text
      ><text fill="rgb(51,51,51)" x="266.7373" xml:space="preserve" y="749.6797" stroke="none"
      >(MOD(it,itau_physics)==0)</text
      ><polygon fill="none" points=" 251 718 548 718 508 744 548 771 251 771" stroke="rgb(51,51,51)"
      /><rect x="251.7373" width="56.7012" height="26.2969" y="781.125" stroke="none"
      /><text fill="rgb(51,51,51)" x="266.7373" xml:space="preserve" y="799.125" stroke="none"
      >......</text
      ><rect fill="none" x="251.7373" width="56.7012" height="26.2969" y="781.125" stroke="rgb(51,51,51)"
      /><line y2="807.4219" fill="none" x1="251.7373" x2="251.7373" stroke="rgb(51,51,51)" y1="82.5938"
      /><line y2="82.5938" fill="none" x1="236.7373" x2="251.7373" stroke="rgb(51,51,51)" y1="82.5938"
      /><rect x="10" width="226.7373" height="26.2969" y="82.5938" stroke="none"
      /><text fill="rgb(51,51,51)" x="35" xml:space="preserve" y="100.5938" stroke="none"
      >it=itau0+1,itau0+itaumax</text
      ><rect fill="none" x="10" width="226.7373" height="26.2969" y="82.5938" stroke="rgb(51,51,51)"
      /><line y2="108.8906" fill="none" x1="20" x2="20" stroke="rgb(51,51,51)" y1="82.5938"
      /><rect x="10" width="56.7012" height="26.2969" y="817.4219" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="835.4219" stroke="none"
      >......</text
      ><rect fill="none" x="10" width="56.7012" height="26.2969" y="817.4219" stroke="rgb(51,51,51)"
      /><rect x="10" y="853" width="222" rx="24" ry="16" height="26" stroke="none"
      /><text fill="rgb(51,51,51)" x="25" xml:space="preserve" y="871.7188" stroke="none"
      >END SUBROUTINE timeloop</text
      ><rect x="10" y="853" fill="none" width="222" rx="24" ry="16" height="26" stroke="rgb(51,51,51)"
      /><line y2="864.0156" fill="none" x1="10" x2="10" stroke="rgb(51,51,51)" y1="26"
    /></g
  ></g
></svg
>
